# DifyAppShare

複数のDifyワークフローアプリケーションを統合管理し、ブラウザ上で簡単にチャットテストができる専用ウェブアプリケーションです。

## 概要

DifyAppShareは、Difyワークフロー研修において、受講者が作成したAIアプリケーションが実際の業務でどのように活用されるかをイメージしやすくするためのツールです。複数のワークフローを同時に比較・検証できる環境を提供します。

## 主な機能

- **ワークフロー登録機能**: Difyで公開されたAIワークフローアプリケーションを最大10件まで登録・管理
- **マルチチャットセッション**: デフォルトで10個のチャットスペースを提供し、各スペースで独立したチャットセッションを維持
- **Dify API連携**: DifyのチャットAPIと連携してメッセージ送受信、ストリーミングレスポンスの受信・表示
- **直感的なUI**: 各スペースにアプリケーションを割り当てて、すぐにチャットテストが可能

## 技術スタック

- **フレームワーク**: Next.js 14 (App Router)
- **言語**: TypeScript
- **スタイリング**: Tailwind CSS
- **状態管理**: Zustand
- **HTTPクライアント**: Axios / Fetch API
- **マークダウン表示**: react-markdown
- **アイコン**: lucide-react

## セットアップ

### 必要な環境

- Node.js 18以上
- npm または yarn

### インストール

```bash
# 依存パッケージのインストール
npm install

# 開発サーバーの起動
npm run dev
```

ブラウザで [http://localhost:3000](http://localhost:3000) を開いてください。

### ビルド

```bash
# プロダクションビルド
npm run build

# プロダクションサーバーの起動
npm start
```

## 使い方

### 1. アプリケーションの登録

1. サイドバーの「アプリを追加」ボタンをクリック
2. 以下の情報を入力:
   - アプリ名
   - 説明（任意）
   - APIエンドポイント（例: `https://api.dify.ai/v1`）
   - APIキー
   - 作成者名（任意）
3. 「追加」ボタンをクリック

### 2. チャットセッションの開始

1. チャットスペースの上部にある「アプリを選択」ドロップダウンから、使用したいアプリケーションを選択
2. メッセージ入力欄に質問を入力
3. 送信ボタンをクリック（またはEnterキー）してメッセージを送信

### 3. セッションのリセット

各チャットスペースの右上にあるリセットボタン（回転矢印アイコン）をクリックすると、そのセッションの会話履歴がクリアされます。

## データの保存

- アプリケーション情報、チャットセッション、設定はブラウザのLocalStorageに保存されます
- データは自動的に保存され、ページをリロードしても保持されます

## プロジェクト構造

```
DifyAppShare/
├── app/                    # Next.js App Router
│   ├── layout.tsx          # ルートレイアウト
│   ├── page.tsx            # メインページ
│   └── globals.css         # グローバルスタイル
├── components/             # Reactコンポーネント
│   ├── ChatSpace.tsx       # チャットスペース
│   ├── MessageList.tsx     # メッセージリスト
│   ├── MessageItem.tsx     # メッセージアイテム
│   ├── MessageInput.tsx   # メッセージ入力欄
│   ├── AppSelector.tsx    # アプリ選択ドロップダウン
│   └── AppManager.tsx     # アプリ管理モーダル
├── lib/                    # ライブラリ・ユーティリティ
│   ├── dify-api.ts         # Dify API連携
│   └── storage.ts          # LocalStorage管理
├── stores/                 # Zustandストア
│   ├── app-store.ts        # アプリケーション管理
│   └── session-store.ts    # セッション管理
├── types/                  # TypeScript型定義
│   └── index.ts            # 共通型定義
└── utils/                  # ユーティリティ関数
    └── cn.ts               # className結合ユーティリティ
```

## Dify API仕様

このアプリケーションは、DifyのChat APIを使用しています。

- **エンドポイント**: `{apiEndpoint}/chat-messages`
- **認証**: Bearer Token（APIキー）
- **リクエスト形式**: JSON
- **レスポンス形式**: Server-Sent Events（ストリーミング）

詳細は [Dify公式ドキュメント](https://docs.dify.ai/api-reference) を参照してください。

## ライセンス

このプロジェクトは研修用途で作成されています。

## 開発者向け情報

### 環境変数

現在、環境変数は使用していませんが、将来的な拡張のために `.env.local` ファイルを作成できます。

### カスタマイズ

- チャットスペースの数は `stores/session-store.ts` の `maxSessions` で変更可能
- アプリケーションの最大登録数は `stores/app-store.ts` の `maxApps` で変更可能

## トラブルシューティング

### API接続エラー

- APIエンドポイントとAPIキーが正しいか確認してください
- DifyのAPIレート制限に達していないか確認してください
- ブラウザのコンソールでエラーメッセージを確認してください

### データが保存されない

- ブラウザのLocalStorageが有効になっているか確認してください
- プライベートブラウジングモードではデータが保存されない場合があります

## 今後の拡張予定

- テーマ設定（ライト/ダークモード）
- セッションのエクスポート/インポート機能
- 複数セッションでの同時質問機能
- レスポンス時間の比較表示
- ユーザー認証機能

